1. 멀티 모달 RAG 개요
- RAG는 텍스트 생성 시 관련 정보를 미리 정의된 지식 기반으로부터 검색한 다음, 그 정보를 바탕으로 텍스트를 생성하는 기술이다.
- 일반적인 RAG는 텍스트를 기반으로 하지만 멀티모달 RAG는 텍스트뿐만 아니라, 이미지, 표와 같은 다양한 요소를 동시에 처리하여 정보를 검색하고 이를 활용해 더욱 정교한 답변을 생성한다.

2. 멀티모달 RAG 아키텍처
- 문서의 파싱
 - 우선 Structured Parser를 통해 PDF 파일로부터 텍스트, 테이블, 이미지와 같은 요소를 추출한다.
 - 이 요소들은 각각 요약되어 나중에 검색 시스템을 통해 활용될 수 있도록 저장된다.
  * 텍스트: 텍스트는 일정한 크기로 분할되어 각각의 텍스트 블록에 대한 요약을 생성한다. 이렇게 생성된 텍스트 요약은 검색을 최적화하기 위해 임베딩 형태로 변환되어 저장된다. 이를 통해 효율적인 검색이 가능해진다.
  * 이미지: 이미지는 이미지 요약을 생성하며, 이 요약은 검색을 위한 임베딩에 사용된다.
  * 테이블: 표는 테이블 요약으로 변환되며, 마찬가지로 임베딩을 통해 검색에 최적화된다.

- 데이터 저장 및 검색
 - 추출한 데이터는 요약 데이터베이스에 저장된다.
 - 이 데이터베이스에는 원본 텍스트, 테이블, 이미지가 저장되며 각각의 요약본도 함께 인덱싱된다.
 - 사용자가 질문을 할 때는 검색 엔진이 이 요약본을 바탕으로 관련된 데이터를 빠르게 검색하고, 원본 데이터를 제공하는 방식으로 작동한다.

- 답변 생성
 - 검색된 요약본을 활용하여 멀티모달 LLM이 답변을 생성한다.
 - 이때 실제 생성에는 요약된 정보뿐만 아니라 원본 텍스트, 테이블, 이미지가 그래도 활용된다.
 - 이를 통해 LLM은 더 깉이 있는 분석과 종합적인 답변을 제공할 수 있다.

3. 주요 프로그램 설치
 - Poppler: PDF 파일을 이미지로 변환할 때 필요한 라이브러리
  - 공식: https://pdf2image.readthedocs.io/en/latest/installation.html
  - 다운로드: https://github.com/oschwartz10612/poppler-windows/releases/
 - Tesseract: 이미지에서 텍스트를 추출하는 OCR 엔진이다. 이미지 기반의 텍스트 추출을 위해 사용된다.
  - 다운로드: https://github.com/UB-Mannheim/tesseract/wiki
 
4. 주요 사용 패키지
 - LangChain-Chroma: 임베딩 기반 벡터 검색 엔진으로, 고성능의 벡터 데이터베이스를 제공하여 대용량의 임베딩 데이터를 효율적으로 관리하고 검색할 수 있다. 멀티모달 RAG에서 Chroma는 텍슽, 이미지, 테이블 등의 임베딩을 저장하고 검색을 최적화하여 적절한 데이터를 빠르게 찾는데 사용되며 사용자 요청에 맞는 최적의 데이터를 반환한다.
 - LangChain-Experimental: 랭체인의 실험적 모듈로 최신 기능과 실험적 도구들을 제공하여 랭체인의 성능을 확장시킨다. 멀티모달 RAG에서 이 모듈을 사용하여 다양한 최신 기능들을 활용해 데이터 검색 및 처리를 최적화하고 더욱 정교한 멀티보달 검색을 구현한다.
 - Unstructured: 여러 형태의 문서(PDF, Word, HTML, TEXT 등)에서 구조화되지 않은 데이터를 추출하는 라이브러리다. 이를 통해 문서에서 텍스트, 테이블, 이미지 등의 요소를 쉽게 추출할 수 있다. 멀티모달 RAG에서 PDF 파일이나 문서로부터 데이터를 분리해내고, 이를 임베딩하여 검색 가능항 형식으로 변환한다. 이 데이터는 나중에 검색을 통해 모델이 응답을 생성하는 데 사용된다.
 - Pillow: 이미지 처리를 위한 파이썬 라이브러리로 이미지 열기, 편집, 저장 등 다양한 작업을 지원한다. 멀티모달 RAG에서 PDF에서 추출한 이미지 파일을 처리하고 이를 입베딩할 때 필요한 이미지 전처리 작업에 사용된다.
 - Pydantic: 데이터 유효성 검사와 데이터 모델링을 위한 라이브러리이다. 파이썬의 데이터 구조를 쉽게 정의하고 입력 데이터의 유효성을 검사할 수 있도록 도와준다. 멀티모달 RAG에서 복잡한 데이터 구조를 처리할 때 데이터를 일관되게 유지하고 모델 간 데이터 전송을 정확하게 관리한다.
 - Lxml: XML 및 HTML을 파싱하고 조작하기 위한 라이브러리다. 이를 사용하면 웹 문서나 XML 기반 문서에서 데이터를 추출할 수 있다. 멀티모달 RAG에서는 XML 또는 HTML 구조로 된 문서에서 데이터를 추출하고 처리하는 데 사용된다. 특히 웹 기반 문서에서 유용하다.
 - pip install "unstructured[all-docs]"